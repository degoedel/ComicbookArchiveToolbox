<UserControl x:Class="ComicbookArchiveToolbox.Views.HostView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:prism="http://prismlibrary.com/"
             xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
             xmlns:converters="clr-namespace:ComicbookArchiveToolbox.CommonTools"
             xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
             prism:ViewModelLocator.AutoWireViewModel="True">
	<UserControl.Resources>
		<converters:InverseBoolToVisibilityConverter x:Key="InverseVisibilityConverter"/>
		<BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
	</UserControl.Resources>

	<Grid Background="{DynamicResource MahApps.Brushes.ThemeBackground}">
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="80"/>
			<ColumnDefinition Width="*"/>
		</Grid.ColumnDefinitions>

		<!-- Dark Theme Navigation Sidebar -->
		<Border Grid.Column="0" Style="{StaticResource NavigationSidebar}">
			<StackPanel Margin="0,20">
				<Button Style="{StaticResource NavigationButton}" 
                        Command="{Binding DisplayCompressCommand}" 
                        ToolTip="{Binding ToolCompressDescription}">
					<iconPacks:PackIconModern Kind="Archive" Width="24" Height="24"/>
				</Button>
				<Button Style="{StaticResource NavigationButton}" 
                        Command="{Binding DisplaySplitCommand}" 
                        ToolTip="{Binding ToolSplitDescription}">
					<iconPacks:PackIconModern Kind="Slice" Width="24" Height="24"/>
				</Button>
				<Button Style="{StaticResource NavigationButton}" 
                        Command="{Binding DisplayMergeCommand}" 
                        ToolTip="{Binding ToolMergeDescription}">
					<iconPacks:PackIconModern Kind="Paperclip" Width="24" Height="24"/>
				</Button>
				<Button Style="{StaticResource NavigationButton}" 
                        Command="{Binding DisplayEditCommand}" 
                        ToolTip="{Binding ToolEditDescription}">
					<iconPacks:PackIconModern Kind="PageEdit" Width="24" Height="24"/>
				</Button>
				<Rectangle Height="1" Fill="{DynamicResource MahApps.Brushes.Gray5}" Margin="15,20"/>
				<Button Style="{StaticResource NavigationButton}" 
                        Command="{Binding DisplaySettingsCommand}" 
                        ToolTip="{Binding ToolSettingsDescription}">
					<iconPacks:PackIconModern Kind="Cog" Width="24" Height="24"/>
				</Button>
				<Button Style="{StaticResource NavigationButton}" 
                        Command="{Binding DisplayAboutCommand}" 
                        ToolTip="{Binding ToolAboutDescription}">
					<iconPacks:PackIconModern Kind="InformationCircle" Width="24" Height="24"/>
				</Button>
			</StackPanel>
		</Border>

		<!-- Main Content Area -->
		<Grid Grid.Column="1" Background="{DynamicResource MahApps.Brushes.ThemeBackground}">
			<Grid.RowDefinitions>
				<RowDefinition Height="*"/>
				<RowDefinition Height="Auto"/>
			</Grid.RowDefinitions>

			<!-- Content Region with Dark Theme Card -->
			<Border Grid.Row="0" Style="{StaticResource ModernCard}" Margin="16">
				<ContentControl prism:RegionManager.RegionName="PluginRegion"/>
			</Border>

			<!-- Dark Theme Log Panel -->
			<Border Grid.Row="1" 
                    Style="{StaticResource LogPanel}" 
                    Margin="16,0,16,16"
                    Visibility="{Binding HideLog, Converter={StaticResource InverseVisibilityConverter}}">
				<StackPanel>
					<DockPanel Margin="0,0,0,8">
						<iconPacks:PackIconModern Kind="Console" 
                                                  Width="16" 
                                                  Height="16" 
                                                  Foreground="{DynamicResource MahApps.Brushes.Accent}"
                                                  DockPanel.Dock="Left" 
                                                  VerticalAlignment="Center"/>
						<TextBlock Text="Application Log" 
                                   Foreground="{DynamicResource MahApps.Brushes.Accent}" 
                                   FontWeight="SemiBold" 
                                   DockPanel.Dock="Left" 
                                   VerticalAlignment="Center"
                                   Margin="8,0,0,0"/>
						<Button Width="20" 
                                Height="20" 
                                DockPanel.Dock="Right" 
                                Command="{Binding HideLogCommand}" 
                                ToolTip="Hide log"
                                Style="{StaticResource MahApps.Styles.Button.Circle}"
                                Background="{DynamicResource MahApps.Brushes.Gray4}"
                                Foreground="{DynamicResource MahApps.Brushes.Text}">
							<iconPacks:PackIconModern Kind="Close" Width="12" Height="12"/>
						</Button>
					</DockPanel>
					<ScrollViewer MaxHeight="120" VerticalScrollBarVisibility="Auto">
						<TextBox Text="{Binding CommonLog, Mode=OneWay}" 
                                 IsReadOnly="True"
                                 Background="{DynamicResource MahApps.Brushes.Gray1}"
                                 Foreground="{DynamicResource MahApps.Brushes.Gray9}"
                                 BorderThickness="1"
                                 BorderBrush="{DynamicResource MahApps.Brushes.Gray4}"
                                 TextWrapping="Wrap"
                                 FontFamily="Consolas"
                                 FontSize="11"
                                 Padding="8"/>
					</ScrollViewer>
				</StackPanel>
			</Border>

			<!-- Enhanced Dark Theme Busy Indicator -->
			<Grid Grid.RowSpan="2" 
                  Background="#DD000000"
                  Visibility="{Binding IsBusy, Converter={StaticResource BooleanToVisibilityConverter}}">
				<StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
					<mah:ProgressRing IsActive="{Binding IsBusy}" 
                                      Width="60" 
                                      Height="60"
                                      Foreground="{DynamicResource MahApps.Brushes.Accent}"/>
					<TextBlock Text="Processing..." 
                               Foreground="{DynamicResource MahApps.Brushes.Text}"
                               FontSize="14"
                               HorizontalAlignment="Center"
                               Margin="0,16,0,0"/>
				</StackPanel>
			</Grid>
		</Grid>
	</Grid>
</UserControl>